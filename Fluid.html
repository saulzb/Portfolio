<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saul Zidulka-Bejcek | Fluid</title>

<link href="https://fonts.googleapis.com/css2?family=Michroma&display=swap" rel="stylesheet">

<style>
html, body {
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  font-family:'Michroma',sans-serif;
  background:#111;
  color:#eee;
  scroll-behavior:smooth;
  overflow-x:hidden;
  scroll-snap-type:y mandatory;
}
body::-webkit-scrollbar { width:0; height:0; }
body { scrollbar-width:none; }

section {
  width:100%;
  height:100vh;
  box-sizing:border-box;
  position:relative;
  display:flex;
  flex-direction:column;
  scroll-snap-align:start;
  overflow:hidden;
  opacity:0;
  transition:opacity 0.9s ease;
}
section.visible { opacity:1; }

/* ---------------- CATEGORY SECTION ---------------- */
.category-section {
  padding-top:120px;
  align-items:flex-start;
}

/* ---------------- CLASSIC MAC OS TITLE ---------------- */
.mac-title {
  display:inline-block;
  padding:6px 14px;
  margin:0 0 50px 40px;

  font-size:0.9rem;
  letter-spacing:0.08em;

  color:#000;
  background:#d6d6d6;

  border-top:2px solid #fff;
  border-left:2px solid #fff;
  border-right:2px solid #7a7a7a;
  border-bottom:2px solid #7a7a7a;

  box-shadow:
    inset 1px 1px 0 #f5f5f5,
    inset -1px -1px 0 #8a8a8a;

  image-rendering:pixelated;
}

/* ---------------- PHOTO GRID ---------------- */
.category-row {
  display:flex;
  flex-wrap:wrap;
  justify-content:flex-start;
  gap:40px;
  margin-left:40px;
  margin-bottom:40px;
}

.category-row img {
  width:180px;
  height:180px;
  object-fit:cover;
  border-radius:6px;
  box-shadow:0 8px 20px rgba(0,0,0,0.45);
  background:linear-gradient(145deg,#333,#222);
  cursor:pointer;
  position:relative;
}

/* Mac-style gloss */
.category-row img::after {
  content:"";
  position:absolute;
  inset:0;
  border-radius:6px;
  pointer-events:none;
  background:linear-gradient(
    120deg,
    rgba(255,255,255,0.2) 0%,
    rgba(255,255,255,0) 60%
  );
  transform:translateX(-100%);
  animation:gloss 3s infinite linear;
}

@keyframes gloss {
  0% { transform:translateX(-100%); }
  100% { transform:translateX(100%); }
}

/* Photo numbering */
.photo-number {
  display:block;
  margin-top:6px;
  font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;
  font-size:0.75rem;
  color:#ccc;
  text-align:center;
}

/* ---------------- LIGHTBOX ---------------- */
#lightboxOverlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.92);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}
#lightboxOverlay img {
  max-width:90vw;
  max-height:90vh;
  border-radius:4px;
}
.lightbox-arrow {
  position:fixed;
  top:50%;
  transform:translateY(-50%);
  font-size:48px;
  background:none;
  border:none;
  color:white;
  cursor:pointer;
}
#lightbox-prev { left:30px; }
#lightbox-next { right:30px; }
#lightbox-close {
  position:fixed;
  top:20px;
  right:30px;
  font-size:42px;
  background:none;
  border:none;
  color:white;
  cursor:pointer;
}

/* Back arrow */
.back-arrow {
  position:absolute;
  top:20px;
  left:30px;
  font-size:28px;
  cursor:pointer;
  color:white;
  user-select:none;
  transform:rotate(270deg);
}
</style>
</head>

<body>

<div class="back-arrow" onclick="window.location.href='index.html'">^</div>

<div id="photoSections"></div>

<div id="lightboxOverlay">
  <button id="lightbox-close">×</button>
  <button id="lightbox-prev" class="lightbox-arrow">❮</button>
  <img id="lightbox-img" src="">
  <button id="lightbox-next" class="lightbox-arrow">❯</button>
</div>

<script>
const SPACE_ID = '5w319pzc4eiq';
const ACCESS_TOKEN = 'l_S14vNHPLKqDVzZDxMSlO3g3AhMne9mAvyC74dyetg';

/* OPTION B */
const CATEGORY_FILTER = "TI";   // Contentful category
const DISPLAY_NAME = "Fluid";  // Visible title

async function fetchPhotos(){
  const res = await fetch(
    `https://cdn.contentful.com/spaces/${SPACE_ID}/entries?content_type=photo&access_token=${ACCESS_TOKEN}&include=1`
  );
  const data = await res.json();

  const assets = {};
  data.includes?.Asset?.forEach(a => {
    assets[a.sys.id] = a.fields.file.url;
  });

  const photos = data.items
    .map(i => ({
      title: i.fields.title,
      photo: `https:${assets[i.fields.photo.sys.id]}`,
      thumbnail: i.fields.thumbnail
        ? `https:${assets[i.fields.thumbnail.sys.id]}`
        : "",
      category: i.fields.category
    }))
    .filter(p => p.category === CATEGORY_FILTER);

  displayPhotos(photos);
}

function displayPhotos(photos){
  const container = document.getElementById("photoSections");

  const section = document.createElement("section");
  section.className = "category-section";
  section.innerHTML = `<h2 class="mac-title">${DISPLAY_NAME}</h2>`;

  let counter = 1;
  const row = document.createElement("div");
  row.className = "category-row";

  photos.forEach(p => {
    const img = document.createElement("img");
    img.src = p.thumbnail || p.photo;
    img.dataset.full = p.photo;

    const number = document.createElement("span");
    number.className = "photo-number";
    number.textContent = "IMG_" + String(counter).padStart(2,"0");
    counter++;

    const wrapper = document.createElement("div");
    wrapper.style.display = "flex";
    wrapper.style.flexDirection = "column";
    wrapper.style.alignItems = "center";
    wrapper.appendChild(img);
    wrapper.appendChild(number);

    row.appendChild(wrapper);
  });

  section.appendChild(row);
  container.appendChild(section);

  observer.observe(section);
  enableLightbox();
}

const observer = new IntersectionObserver(entries=>{
  entries.forEach(e=>{
    if(e.isIntersecting) e.target.classList.add("visible");
  });
},{threshold:0.3});

function enableLightbox(){
  let lbImages=[], lbIndex=0;

  document.querySelectorAll(".category-row img").forEach(img=>{
    img.onclick=()=>{
      const imgs=[...img.parentElement.parentElement.querySelectorAll("img")];
      lbImages=imgs.map(i=>i.dataset.full);
      lbIndex=imgs.indexOf(img);
      openLB();
    };
  });

  function openLB(){
    document.body.style.overflow="hidden";
    document.getElementById("lightbox-img").src=lbImages[lbIndex];
    document.getElementById("lightboxOverlay").style.display="flex";
  }
  function closeLB(){
    document.body.style.overflow="";
    document.getElementById("lightboxOverlay").style.display="none";
  }
  function nextLB(){
    lbIndex=(lbIndex+1)%lbImages.length;
    document.getElementById("lightbox-img").src=lbImages[lbIndex];
  }
  function prevLB(){
    lbIndex=(lbIndex-1+lbImages.length)%lbImages.length;
    document.getElementById("lightbox-img").src=lbImages[lbIndex];
  }

  document.getElementById("lightbox-close").onclick=closeLB;
  document.getElementById("lightbox-next").onclick=nextLB;
  document.getElementById("lightbox-prev").onclick=prevLB;

  window.addEventListener("keydown",e=>{
    if(document.getElementById("lightboxOverlay").style.display!=="flex") return;
    if(e.key==="ArrowRight") nextLB();
    if(e.key==="ArrowLeft") prevLB();
    if(e.key==="Escape") closeLB();
  });
}

fetchPhotos();
</script>

</body>
</html>
