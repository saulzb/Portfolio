<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saul Zidulka-Bejcek | Fluid</title>

<link href="https://fonts.googleapis.com/css2?family=Michroma&display=swap" rel="stylesheet">

<style>
html, body {
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  font-family:'Michroma',sans-serif;
  background:#0b0b0d;
  color:#e6e6e6;
  overflow-x:hidden;
}

/* ---------------- SECTION ---------------- */
section {
  width:100%;
  height:100vh;
  display:flex;
  flex-direction:column;
  opacity:0;
  transition:opacity 0.8s ease;
}
section.visible { opacity:1; }

.category-section {
  padding-top:120px;
  align-items:flex-start;
}

/* ---------------- PRISM / CRT TITLE ---------------- */
.os-title {
  position:relative;
  margin:0 0 50px 40px;
  padding:10px 18px;
  background:#161618;

  border-top:1px solid #2a2a2d;
  border-left:1px solid #2a2a2d;
  border-right:1px solid #000;
  border-bottom:1px solid #000;

  font-size:0.8rem;
  letter-spacing:0.18em;
  text-transform:uppercase;

  image-rendering:pixelated;
  overflow:hidden;
}

/* BASE TEXT */
.os-title .base {
  position:relative;
  color:#e2e2e2;
  z-index:3;
}

/* RED CHANNEL */
.os-title .r {
  position:absolute;
  top:10px;
  left:16px;
  color:#ff3b3b;
  transform:translateX(-2px);
  clip-path:inset(0 20% 0 0);
  opacity:0.8;
  z-index:1;
}

/* BLUE CHANNEL */
.os-title .b {
  position:absolute;
  top:10px;
  left:16px;
  color:#3b6bff;
  transform:translateX(2px);
  clip-path:inset(0 0 0 20%);
  opacity:0.8;
  z-index:1;
}

/* GREEN CHANNEL */
.os-title .g {
  position:absolute;
  top:11px;
  left:16px;
  color:#4bff7a;
  transform:translateY(1px);
  clip-path:inset(20% 0 0 0);
  opacity:0.6;
  z-index:0;
}

/* subtle scanline breakup ONLY on base */
.os-title::after {
  content:"";
  position:absolute;
  inset:0;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(255,255,255,0.04),
      rgba(255,255,255,0.04) 1px,
      transparent 1px,
      transparent 3px
    );
  pointer-events:none;
  opacity:0.25;
}

/* ---------------- GRID ---------------- */
.category-row {
  display:flex;
  flex-wrap:wrap;
  gap:40px;
  margin-left:40px;
}

.category-row img {
  width:180px;
  height:180px;
  object-fit:cover;
  background:#111;
  border-radius:3px;
  box-shadow:
    0 0 0 1px rgba(255,255,255,0.05),
    0 10px 24px rgba(0,0,0,0.6);
  cursor:pointer;
}

.photo-number {
  margin-top:6px;
  font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",sans-serif;
  font-size:0.75rem;
  color:#9a9a9a;
  text-align:center;
}

/* ---------------- LIGHTBOX ---------------- */
#lightboxOverlay {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.95);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
}

#lightboxOverlay img {
  max-width:90vw;
  max-height:90vh;
}

.lightbox-arrow {
  position:fixed;
  top:50%;
  transform:translateY(-50%);
  font-size:48px;
  background:none;
  border:none;
  color:#e6e6e6;
  cursor:pointer;
}

#lightbox-prev { left:30px; }
#lightbox-next { right:30px; }
#lightbox-close {
  position:fixed;
  top:20px;
  right:30px;
  font-size:42px;
  background:none;
  border:none;
  color:#e6e6e6;
  cursor:pointer;
}

/* back arrow */
.back-arrow {
  position:absolute;
  top:20px;
  left:30px;
  font-size:28px;
  cursor:pointer;
  transform:rotate(270deg);
}
</style>
</head>

<body>

<div class="back-arrow" onclick="window.location.href='index.html'">^</div>
<div id="photoSections"></div>

<div id="lightboxOverlay">
  <button id="lightbox-close">×</button>
  <button id="lightbox-prev" class="lightbox-arrow">❮</button>
  <img id="lightbox-img">
  <button id="lightbox-next" class="lightbox-arrow">❯</button>
</div>

<script>
const SPACE_ID = '5w319pzc4eiq';
const ACCESS_TOKEN = 'l_S14vNHPLKqDVzZDxMSlO3g3AhMne9mAvyC74dyetg';

const CATEGORY_FILTER = "TI";
const DISPLAY_NAME = "Fluid";

async function fetchPhotos(){
  const res = await fetch(
    `https://cdn.contentful.com/spaces/${SPACE_ID}/entries?content_type=photo&access_token=${ACCESS_TOKEN}&include=1`
  );
  const data = await res.json();

  const assets = {};
  data.includes?.Asset?.forEach(a=>{
    assets[a.sys.id] = a.fields.file.url;
  });

  const photos = data.items
    .map(i=>({
      photo:`https:${assets[i.fields.photo.sys.id]}`,
      thumbnail:i.fields.thumbnail
        ? `https:${assets[i.fields.thumbnail.sys.id]}`
        : "",
      category:i.fields.category
    }))
    .filter(p=>p.category === CATEGORY_FILTER);

  displayPhotos(photos);
}

function displayPhotos(photos){
  const section = document.createElement("section");
  section.className = "category-section visible";

  section.innerHTML = `
    <div class="os-title">
      <div class="r">${DISPLAY_NAME}</div>
      <div class="g">${DISPLAY_NAME}</div>
      <div class="b">${DISPLAY_NAME}</div>
      <div class="base">${DISPLAY_NAME}</div>
    </div>
  `;

  const row = document.createElement("div");
  row.className = "category-row";

  let i = 1;
  photos.forEach(p=>{
    const img = document.createElement("img");
    img.src = p.thumbnail || p.photo;
    img.dataset.full = p.photo;

    const num = document.createElement("div");
    num.className = "photo-number";
    num.textContent = "IMG_" + String(i++).padStart(2,"0");

    const wrap = document.createElement("div");
    wrap.style.display="flex";
    wrap.style.flexDirection="column";
    wrap.style.alignItems="center";
    wrap.appendChild(img);
    wrap.appendChild(num);

    row.appendChild(wrap);
  });

  section.appendChild(row);
  document.getElementById("photoSections").appendChild(section);
  enableLightbox();
}

function enableLightbox(){
  let imgs=[], idx=0;
  document.querySelectorAll(".category-row img").forEach(img=>{
    img.onclick=()=>{
      const rowImgs=[...img.parentElement.parentElement.querySelectorAll("img")];
      imgs=rowImgs.map(i=>i.dataset.full);
      idx=rowImgs.indexOf(img);
      open();
    };
  });

  function open(){
    document.body.style.overflow="hidden";
    document.getElementById("lightbox-img").src=imgs[idx];
    document.getElementById("lightboxOverlay").style.display="flex";
  }
  function close(){
    document.body.style.overflow="";
    document.getElementById("lightboxOverlay").style.display="none";
  }
  function next(){ idx=(idx+1)%imgs.length; open(); }
  function prev(){ idx=(idx-1+imgs.length)%imgs.length; open(); }

  document.getElementById("lightbox-close").onclick=close;
  document.getElementById("lightbox-next").onclick=next;
  document.getElementById("lightbox-prev").onclick=prev;
}

fetchPhotos();
</script>

</body>
</html>
