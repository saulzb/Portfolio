<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saul Zidulka-Bejcek | Dream State</title>

<link href="https://fonts.googleapis.com/css2?family=Michroma&display=swap" rel="stylesheet">

<style>
html, body { margin:0; padding:0; width:100%; height:100%; font-family:'Archivo Expanded',sans-serif; background:#111; color:#eee; scroll-behavior:smooth; overflow-x:hidden; scroll-snap-type:y mandatory; }
body::-webkit-scrollbar { width:0; height:0; }
body { scrollbar-width:none; }

section {
  width:100%; height:100vh; box-sizing:border-box;
  position:relative; display:flex; flex-direction:column;
  scroll-snap-align:start; overflow:hidden; opacity:0; transition:opacity 0.9s ease;
}
section.visible { opacity:1; }

.category-section { padding-top:90px; align-items:center; }
section h2 { margin:0; width:100%; text-align:center; color:white; font-family:'Michroma',sans-serif; font-size:1rem; }
section h2::before, section h2::after { content:""; display:inline-block; width:18%; height:1px; background:white; vertical-align:middle; margin:0 8px; }

.category-row { display:flex; gap:10px; height:38vh; width:max-content; }
.category-row img { height:100%; width:auto; border-radius:6px; cursor:zoom-in; }

#lightboxOverlay { position:fixed; inset:0; background:rgba(0,0,0,0.92); display:none; align-items:center; justify-content:center; z-index:9999; }
#lightboxOverlay img { max-width:90vw; max-height:90vh; border-radius:4px; }
.lightbox-arrow { position:fixed; top:50%; transform:translateY(-50%); font-size:48px; background:none; border:none; color:white; cursor:pointer; }
#lightbox-prev { left:30px; } #lightbox-next { right:30px; }
#lightbox-close { position:fixed; top:20px; right:30px; font-size:42px; background:none; border:none; color:white; cursor:pointer; }

.arrow-up { position:absolute; top:20px; left:30px; cursor:pointer; font-size:1.2rem; color:white; display:flex; flex-direction:column; align-items:center; }
.arrow-up span { font-size:0.7rem; margin-top:3px; }
</style>
</head>
<body>

<div class="arrow-up" onclick="window.location.href='index.html'">↑<span>Folders</span></div>

<div id="photoSections"></div>

<div id="lightboxOverlay">
  <button id="lightbox-close">×</button>
  <button id="lightbox-prev" class="lightbox-arrow">❮</button>
  <img id="lightbox-img" src="">
  <button id="lightbox-next" class="lightbox-arrow">❯</button>
</div>

<script>
const SPACE_ID = '5w319pzc4eiq';
const ACCESS_TOKEN = 'l_S14vNHPLKqDVzZDxMSlO3g3AhMne9mAvyC74dyetg';
const CATEGORY_NAME = "channelORANGE"; // <-- change per page

async function fetchPhotos(){
  const res = await fetch(`https://cdn.contentful.com/spaces/${SPACE_ID}/entries?content_type=photo&access_token=${ACCESS_TOKEN}&include=1`);
  const data = await res.json();

  const assets = {};
  data.includes?.Asset?.forEach(a => assets[a.sys.id] = a.fields.file.url);

  const photos = data.items.map(i=>({
    title:i.fields.title,
    photo:`https:${assets[i.fields.photo.sys.id]}`,
    thumbnail:i.fields.thumbnail ? `https:${assets[i.fields.thumbnail.sys.id]}` : "",
    category:i.fields.category,
    featured:i.fields.featured
  })).filter(p=>p.category === CATEGORY_NAME);

  displayPhotos(photos);
}

function displayPhotos(photos){
  const container = document.getElementById("photoSections");

  const section = document.createElement("section");
  section.className = "category-section";
  section.innerHTML = `<h2>${CATEGORY_NAME}</h2>`;

  const mid = Math.ceil(photos.length/2);
  [photos.slice(0,mid), photos.slice(mid)].forEach(rowItems=>{
    const row = document.createElement("div");
    row.className = "category-row";
    rowItems.forEach(p=>{
      const img = document.createElement("img");
      img.src = p.thumbnail || p.photo;
      img.dataset.full = p.photo;
      row.appendChild(img);
    });
    section.appendChild(row);
  });

  container.appendChild(section);

  document.querySelectorAll("section").forEach(s=>observer.observe(s));
  enableLightbox();
}

const observer = new IntersectionObserver(entries=>{
  entries.forEach(e=>{if(e.isIntersecting) e.target.classList.add("visible");});
},{threshold:0.3});

function enableLightbox(){
  let lbImages=[], lbIndex=0;
  document.querySelectorAll(".category-row img").forEach(img=>{
    img.onclick=()=>{
      const rowImgs=[...img.parentElement.querySelectorAll("img")];
      lbImages=rowImgs.map(i=>i.dataset.full);
      lbIndex=rowImgs.indexOf(img);
      openLB();
    };
  });

  function openLB(){ document.body.style.overflow="hidden"; document.getElementById("lightbox-img").src=lbImages[lbIndex]; document.getElementById("lightboxOverlay").style.display="flex"; }
  function closeLB(){ document.body.style.overflow=""; document.getElementById("lightboxOverlay").style.display="none"; }
  function nextLB(){ lbIndex=(lbIndex+1)%lbImages.length; document.getElementById("lightbox-img").src=lbImages[lbIndex]; }
  function prevLB(){ lbIndex=(lbIndex-1+lbImages.length)%lbImages.length; document.getElementById("lightbox-img").src=lbImages[lbIndex]; }

  document.getElementById("lightbox-close").onclick=closeLB;
  document.getElementById("lightbox-next").onclick=nextLB;
  document.getElementById("lightbox-prev").onclick=prevLB;

  window.addEventListener("keydown",e=>{
    if(document.getElementById("lightboxOverlay").style.display!=="flex") return;
    if(e.key==="ArrowRight") nextLB();
    if(e.key==="ArrowLeft") prevLB();
    if(e.key==="Escape") closeLB();
  });
}

fetchPhotos();
</script>

</body>
</html>
